<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Astra.UI.Styles.Windows">

    <!-- ==================== 窗口按钮基础样式 ==================== -->
    <Style x:Key="WindowButtonStyle"
           TargetType="Button">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Foreground"
                Value="{DynamicResource PrimaryTextBrush}" />
        <Setter Property="BorderThickness"
                Value="0" />
        <Setter Property="Width"
                Value="46" />
        <Setter Property="Height"
                Value="32" />
        <Setter Property="Cursor"
                Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="{TemplateBinding Background}"
                            BorderThickness="0">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver"
                     Value="True">
                <Setter Property="Background"
                        Value="{DynamicResource SecondaryRegionBrush}" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- 关闭按钮特殊样式 -->
    <Style x:Key="CloseButtonStyle"
           TargetType="Button"
           BasedOn="{StaticResource WindowButtonStyle}">
        <Style.Triggers>
            <Trigger Property="IsMouseOver"
                     Value="True">
                <Setter Property="Background"
                        Value="#E81123" />
                <Setter Property="Foreground"
                        Value="White" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- ==================== 图标按钮样式 ==================== -->
    <Style x:Key="IconButtonStyle"
           TargetType="Button">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Foreground"
                Value="{DynamicResource PrimaryTextBrush}" />
        <Setter Property="BorderThickness"
                Value="0" />
        <Setter Property="Width"
                Value="40" />
        <Setter Property="Height"
                Value="32" />
        <Setter Property="Cursor"
                Value="Hand" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="border"
                            Background="{TemplateBinding Background}"
                            CornerRadius="8"
                            Padding="8">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter TargetName="border"
                                    Property="Background"
                                    Value="{DynamicResource SecondaryRegionBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- ==================== 自定义窗体样式 ==================== -->
    <Style x:Key="AstraWindowStyle"
           TargetType="Window">
        <Setter Property="Background"
                Value="{DynamicResource BackgroundBrush}" />
        <Setter Property="Foreground"
                Value="{DynamicResource PrimaryTextBrush}" />
        <Setter Property="BorderBrush"
                Value="{DynamicResource BorderBrush}" />
        <Setter Property="BorderThickness"
                Value="1" />
        <Setter Property="UseLayoutRounding"
                Value="True" />
        <Setter Property="TextOptions.TextFormattingMode"
                Value="Display" />
        <Setter Property="WindowChrome.WindowChrome">
            <Setter.Value>
                <WindowChrome CaptionHeight="40"
                              ResizeBorderThickness="5"
                              GlassFrameThickness="0"
                              CornerRadius="0"
                              UseAeroCaptionButtons="False" />
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Window">
                    <Border x:Name="RootBorder"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <!-- 标题栏 -->
                                <RowDefinition Height="*" />
                                <!-- 内容区 -->
                            </Grid.RowDefinitions>

                            <!-- ==================== 自定义标题栏 ==================== -->
                            <Border x:Name="TitleBar"
                                    Grid.Row="0"
                                    Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="0,0,0,1"
                                    Height="40">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <!-- 左侧自定义内容 -->
                                        <ColumnDefinition Width="Auto" />
                                        <!-- 右侧按钮区 -->
                                    </Grid.ColumnDefinitions>

                                    <!-- 左侧内容区（通过 Tag 传入） -->
                                    <ContentPresenter Grid.Column="0"
                                                      Content="{TemplateBinding Tag}"
                                                      WindowChrome.IsHitTestVisibleInChrome="True" />

                                    <!-- 右侧按钮区 -->
                                    <StackPanel Grid.Column="1"
                                                Orientation="Horizontal"
                                                WindowChrome.IsHitTestVisibleInChrome="True">

                                        <!-- 主题切换按钮 -->
                                        <Button x:Name="PART_ThemeButton"
                                                Style="{StaticResource IconButtonStyle}"
                                                ToolTip="切换主题">
                                            <Path Data="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                                  Stretch="Uniform"
                                                  Width="16"
                                                  Height="16" />
                                        </Button>

                                        <!-- 系统状态 -->
                                        <Border x:Name="PART_SystemStatus"
                                                Padding="12,0"
                                                Height="32"
                                                ToolTip="系统状态：正常运行">
                                            <StackPanel Orientation="Horizontal"
                                                        VerticalAlignment="Center">
                                                <!-- 状态指示灯 -->
                                                <Grid Width="8"
                                                      Height="8"
                                                      Margin="0,0,6,0">
                                                    <!-- 脉动外圈 -->
                                                    <Ellipse x:Name="StatusPulse"
                                                             Fill="{DynamicResource SuccessBrush}">
                                                        <Ellipse.Triggers>
                                                            <EventTrigger RoutedEvent="Loaded">
                                                                <BeginStoryboard>
                                                                    <Storyboard RepeatBehavior="Forever">
                                                                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                                         From="1"
                                                                                         To="0.3"
                                                                                         Duration="0:0:1.5"
                                                                                         AutoReverse="True">
                                                                            <DoubleAnimation.EasingFunction>
                                                                                <SineEase EasingMode="EaseInOut" />
                                                                            </DoubleAnimation.EasingFunction>
                                                                        </DoubleAnimation>
                                                                    </Storyboard>
                                                                </BeginStoryboard>
                                                            </EventTrigger>
                                                        </Ellipse.Triggers>
                                                    </Ellipse>
                                                    <!-- 内圈实心 -->
                                                    <Ellipse Width="8"
                                                             Height="8"
                                                             Fill="{DynamicResource SuccessBrush}" />
                                                </Grid>
                                                <!-- 状态文本 -->
                                                <TextBlock Text="运行中"
                                                           FontSize="11"
                                                           Foreground="{DynamicResource SecondaryTextBrush}"
                                                           VerticalAlignment="Center" />
                                            </StackPanel>
                                        </Border>

                                        <!-- 用户按钮 -->
                                        <Button x:Name="PART_UserButton"
                                                Style="{StaticResource IconButtonStyle}"
                                                ToolTip="用户中心"
                                                Margin="0,0,4,0">
                                            <Border Width="20"
                                                    Height="20"
                                                    CornerRadius="10"
                                                    Background="{DynamicResource PrimaryBrush}"
                                                    BorderBrush="{DynamicResource BorderBrush}"
                                                    BorderThickness="1">
                                                <TextBlock Text="A"
                                                           FontSize="11"
                                                           FontWeight="Bold"
                                                           Foreground="White"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />
                                            </Border>
                                        </Button>

                                        <!-- 分隔线 -->
                                        <Rectangle Width="1"
                                                   Height="18"
                                                   Fill="{DynamicResource BorderBrush}"
                                                   Opacity="0.3"
                                                   Margin="4,0"
                                                   VerticalAlignment="Center" />

                                        <!-- 最小化 -->
                                        <Button x:Name="PART_MinimizeButton"
                                                Style="{StaticResource WindowButtonStyle}"
                                                ToolTip="最小化">
                                            <Path Data="M5 12h14"
                                                  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                                  StrokeThickness="1.5"
                                                  Stretch="Uniform"
                                                  Width="12"
                                                  Height="12" />
                                        </Button>

                                        <!-- 最大化/还原 -->
                                        <Button x:Name="PART_MaximizeButton"
                                                Style="{StaticResource WindowButtonStyle}"
                                                ToolTip="最大化">
                                            <Path x:Name="MaximizeIcon"
                                                  Data="M4 4h16v16H4V4z"
                                                  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                                  StrokeThickness="1.5"
                                                  Stretch="Uniform"
                                                  Width="12"
                                                  Height="12" />
                                        </Button>

                                        <!-- 关闭 -->
                                        <Button x:Name="PART_CloseButton"
                                                Style="{StaticResource CloseButtonStyle}"
                                                ToolTip="关闭">
                                            <Path Data="M6 18L18 6M6 6l12 12"
                                                  Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                                  StrokeThickness="1.5"
                                                 
                                                  Stretch="Uniform"
                                                  Width="12"
                                                  Height="12" />
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- ==================== 内容区 ==================== -->
                            <AdornerDecorator Grid.Row="1">
                                <ContentPresenter />
                            </AdornerDecorator>
                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <!-- 最大化状态 -->
                        <Trigger Property="WindowState"
                                 Value="Maximized">
                            <Setter TargetName="RootBorder"
                                    Property="BorderThickness"
                                    Value="0" />
                            <Setter TargetName="RootBorder"
                                    Property="Padding"
                                    Value="7" />
                            <Setter TargetName="MaximizeIcon"
                                    Property="Data"
                                    Value="M4 8h12v12H4V8zM8 4h12v12" />
                            <Setter TargetName="PART_MaximizeButton"
                                    Property="ToolTip"
                                    Value="还原" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>