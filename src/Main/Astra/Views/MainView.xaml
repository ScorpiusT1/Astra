<hc:Window x:Class="Astra.Views.MainView"
           xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
           xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
           xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
           xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
           xmlns:local="clr-namespace:Astra.Views"
           xmlns:hc="https://handyorg.github.io/handycontrol"
           xmlns:utils="clr-namespace:Astra.Utilities"
           xmlns:converters="clr-namespace:Astra.Converters"
           xmlns:baseWindow="clr-namespace:Astra.UI.Styles.Windows;assembly=Astra.UI"
           xmlns:viewmodels="clr-namespace:Astra.ViewModels"
           d:DataContext="{d:DesignInstance Type=viewmodels:MainViewModel}"
           mc:Ignorable="d"
           Background="{DynamicResource BackgroundBrush}"
           WindowState="Maximized"
           NonClientAreaBackground="{DynamicResource SurfaceBrush}"
           NonClientAreaForeground="{DynamicResource PrimaryTextBrush}"
           NonClientAreaHeight="72"
           WindowStartupLocation="CenterScreen"
           Title=""
           ShowIcon="False"
           Height="768"
           Width="1280"
           MouseMove="MainWindow_MouseMove"
           KeyDown="MainWindow_KeyDown"
           MouseDown="MainWindow_MouseDown"
           MouseUp="MainWindow_MouseUp"
           MouseWheel="MainWindow_MouseWheel">

    <hc:Window.Resources>
        <!-- 通用缓动资源 (需在使用前定义) -->
        <BackEase x:Key="EaseOutBack_03"
                  EasingMode="EaseOut"
                  Amplitude="0.3" />
        <BackEase x:Key="EaseOutBack_04"
                  EasingMode="EaseOut"
                  Amplitude="0.4" />
        <CubicEase x:Key="EaseOutCubic"
                   EasingMode="EaseOut" />
        <SineEase x:Key="EaseInOutSine"
                  EasingMode="EaseInOut" />
        <QuadraticEase x:Key="EaseOutQuad"
                       EasingMode="EaseOut" />
        <!-- Logo阴影 -->
        <DropShadowEffect x:Key="LogoShadow"
                          Color="{DynamicResource PrimaryColor}"
                          Opacity="0.4"
                          ShadowDepth="0"
                          BlurRadius="24"
                          Direction="270" />

        <!-- 用户权限到颜色的转换器 -->
        <converters:UserRoleToColorConverter x:Key="UserRoleToColorConverter" />
        <converters:UserRoleToStringConverter x:Key="UserRoleToStringConverter" />
        <converters:UserRoleToEmojiConverter x:Key="UserRoleToEmojiConverter" />
        <converters:FirstLetterConverter x:Key="FirstLetterConverter" />
        <converters:LoginStatusToVisibilityConverter x:Key="LoginStatusToVisibilityConverter" />

        <!-- 布尔值到可见性转换器 -->
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />

        <!-- 导航栏滚动条样式 -->
        <Style x:Key="NavScrollViewerStyle"
               TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid>
                            <ScrollContentPresenter Content="{TemplateBinding Content}"
                                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                                    CanContentScroll="{TemplateBinding CanContentScroll}"
                                                    Margin="{TemplateBinding Padding}" />
                            <ScrollBar x:Name="PART_HorizontalScrollBar"
                                       Orientation="Horizontal"
                                       ViewportSize="{TemplateBinding ViewportWidth}"
                                       Maximum="{TemplateBinding ScrollableWidth}"
                                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                       Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                       Cursor="Arrow"
                                       Height="6"
                                       VerticalAlignment="Bottom"
                                       HorizontalAlignment="Stretch"
                                       Margin="10,0,10,-4"
                                       Opacity="0.8"
                                       Panel.ZIndex="1">
                                <ScrollBar.Style>
                                    <Style TargetType="ScrollBar">
                                        <Setter Property="Background"
                                                Value="Transparent" />
                                        <Setter Property="BorderThickness"
                                                Value="0" />
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ScrollBar">
                                                    <Grid x:Name="GridRoot">
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="*" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>
                                                        <Track x:Name="PART_Track"
                                                               Grid.Row="1"
                                                               Focusable="False"
                                                               IsDirectionReversed="False">
                                                            <Track.DecreaseRepeatButton>
                                                                <RepeatButton Command="ScrollBar.PageLeftCommand"
                                                                              Visibility="Collapsed" />
                                                            </Track.DecreaseRepeatButton>
                                                            <Track.Thumb>
                                                                <Thumb>
                                                                    <Thumb.Template>
                                                                        <ControlTemplate TargetType="Thumb">
                                                                            <Border x:Name="thumbBorder"
                                                                                    Background="{DynamicResource SecondaryTextBrush}"
                                                                                    Opacity="0.4"
                                                                                    CornerRadius="3"
                                                                                    Height="6"
                                                                                    Margin="0,0,0,0" />
                                                                            <ControlTemplate.Triggers>
                                                                                <Trigger Property="IsMouseOver"
                                                                                         Value="True">
                                                                                    <Setter TargetName="thumbBorder"
                                                                                            Property="Background"
                                                                                            Value="{DynamicResource PrimaryBrush}" />
                                                                                    <Setter TargetName="thumbBorder"
                                                                                            Property="Opacity"
                                                                                            Value="0.6" />
                                                                                </Trigger>
                                                                                <Trigger Property="IsDragging"
                                                                                         Value="True">
                                                                                    <Setter TargetName="thumbBorder"
                                                                                            Property="Background"
                                                                                            Value="{DynamicResource PrimaryBrush}" />
                                                                                    <Setter TargetName="thumbBorder"
                                                                                            Property="Opacity"
                                                                                            Value="0.8" />
                                                                                </Trigger>
                                                                            </ControlTemplate.Triggers>
                                                                        </ControlTemplate>
                                                                    </Thumb.Template>
                                                                </Thumb>
                                                            </Track.Thumb>
                                                            <Track.IncreaseRepeatButton>
                                                                <RepeatButton Command="ScrollBar.PageRightCommand"
                                                                              Visibility="Collapsed" />
                                                            </Track.IncreaseRepeatButton>
                                                        </Track>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ScrollBar.Style>
                            </ScrollBar>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 导航按钮样式 -->
        <Style x:Key="NavButtonStyle"
               TargetType="RadioButton">
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Foreground"
                    Value="{DynamicResource SecondaryTextBrush}" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="Padding"
                    Value="18,10" />
            <Setter Property="FontSize"
                    Value="13" />
            <Setter Property="FontWeight"
                    Value="Medium" />
            <Setter Property="Cursor"
                    Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Grid HorizontalAlignment="Center"
                              VerticalAlignment="Center">
                            <Border x:Name="border"
                                    Background="{TemplateBinding Background}"
                                    CornerRadius="10"
                                    Padding="{TemplateBinding Padding}"
                                    Margin="3,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    RenderTransformOrigin="0.5,0.5">
                                <Border.RenderTransform>
                                    <ScaleTransform x:Name="borderScale"
                                                    ScaleX="1"
                                                    ScaleY="1" />
                                </Border.RenderTransform>
                                <StackPanel Orientation="Horizontal"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <TextBlock x:Name="icon"
                                               Text="{TemplateBinding Tag}"
                                               FontSize="16"
                                               Foreground="{TemplateBinding Foreground}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Center"
                                               Margin="0,0,8,0"
                                               RenderTransformOrigin="0.5,0.5">
                                        <TextBlock.RenderTransform>
                                            <ScaleTransform x:Name="iconScale"
                                                            ScaleX="1"
                                                            ScaleY="1" />
                                        </TextBlock.RenderTransform>
                                    </TextBlock>
                                    <TextBlock Text="{TemplateBinding Content}"
                                               Foreground="{TemplateBinding Foreground}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Center" />
                                </StackPanel>
                            </Border>

                            <!-- 底部指示器 -->
                            <Border x:Name="indicator"
                                    Height="3"
                                    Background="{DynamicResource PrimaryBrush}"
                                    CornerRadius="1.5"
                                    VerticalAlignment="Bottom"
                                    HorizontalAlignment="Center"
                                    Margin="8,0,8,1"
                                    Opacity="0"
                                    RenderTransformOrigin="0.5,0.5">
                                <Border.RenderTransform>
                                    <ScaleTransform x:Name="indicatorScale"
                                                    ScaleX="0.5"
                                                    ScaleY="1" />
                                </Border.RenderTransform>
                            </Border>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <!-- 悬停效果 -->
                            <Trigger Property="IsMouseOver"
                                     Value="True">
                                <Setter TargetName="border"
                                        Property="Background"
                                        Value="{DynamicResource SecondaryRegionBrush}" />
                                <Setter Property="Foreground"
                                        Value="{DynamicResource PrimaryTextBrush}" />
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="iconScale"
                                                             Storyboard.TargetProperty="ScaleX"
                                                             To="1.15"
                                                             Duration="0:0:0.2">
                                                <DoubleAnimation.EasingFunction>
                                                    <StaticResource ResourceKey="EaseOutBack_03" />
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                            <DoubleAnimation Storyboard.TargetName="iconScale"
                                                             Storyboard.TargetProperty="ScaleY"
                                                             To="1.15"
                                                             Duration="0:0:0.2">
                                                <DoubleAnimation.EasingFunction>
                                                    <StaticResource ResourceKey="EaseOutBack_03" />
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="iconScale"
                                                             Storyboard.TargetProperty="ScaleX"
                                                             To="1"
                                                             Duration="0:0:0.2" />
                                            <DoubleAnimation Storyboard.TargetName="iconScale"
                                                             Storyboard.TargetProperty="ScaleY"
                                                             To="1"
                                                             Duration="0:0:0.2" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>

                            <!-- 选中状态 -->
                            <Trigger Property="IsChecked"
                                     Value="True">
                                <Setter Property="Foreground"
                                        Value="{DynamicResource ReverseTextBrush}" />
                                <Setter TargetName="border"
                                        Property="Background"
                                        Value="{DynamicResource PrimaryBrush}" />
                                <Setter TargetName="border"
                                        Property="Effect"
                                        Value="{StaticResource ActiveShadow}" />
                            </Trigger>

                            <!-- 未选中悬停时显示指示器 -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver"
                                               Value="True" />
                                    <Condition Property="IsChecked"
                                               Value="False" />
                                </MultiTrigger.Conditions>
                                <MultiTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="indicator"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="0.5"
                                                             Duration="0:0:0.2" />
                                            <DoubleAnimation Storyboard.TargetName="indicatorScale"
                                                             Storyboard.TargetProperty="ScaleX"
                                                             To="1"
                                                             Duration="0:0:0.25">
                                                <DoubleAnimation.EasingFunction>
                                                    <StaticResource ResourceKey="EaseOutCubic" />
                                                </DoubleAnimation.EasingFunction>
                                            </DoubleAnimation>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiTrigger.EnterActions>
                                <MultiTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="indicator"
                                                             Storyboard.TargetProperty="Opacity"
                                                             To="0"
                                                             Duration="0:0:0.15" />
                                            <DoubleAnimation Storyboard.TargetName="indicatorScale"
                                                             Storyboard.TargetProperty="ScaleX"
                                                             To="0.5"
                                                             Duration="0:0:0.15" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiTrigger.ExitActions>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 用户头像样式 -->
        <Style x:Key="AvatarStyle"
               TargetType="Border">
            <Setter Property="RenderTransformOrigin"
                    Value="0.5,0.5" />
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1"
                                    ScaleY="1" />
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver"
                         Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                 To="1.08"
                                                 Duration="0:0:0.2">
                                    <DoubleAnimation.EasingFunction>
                                        <StaticResource ResourceKey="EaseOutBack_03" />
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                 To="1.08"
                                                 Duration="0:0:0.2">
                                    <DoubleAnimation.EasingFunction>
                                        <StaticResource ResourceKey="EaseOutBack_03" />
                                    </DoubleAnimation.EasingFunction>
                                </DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                 To="1"
                                                 Duration="0:0:0.2" />
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                 To="1"
                                                 Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- 脉动动画 -->
        <Storyboard x:Key="PulseAnimation"
                    RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                             From="1"
                             To="0.3"
                             Duration="0:0:1.5"
                             AutoReverse="True">
                <DoubleAnimation.EasingFunction>
                    <StaticResource ResourceKey="EaseInOutSine" />
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </hc:Window.Resources>

    <hc:Window.NonClientAreaContent>
        <!-- 顶部导航栏 -->
        <Border BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,0,0,0"
                ClipToBounds="False">
            <Border.Effect>
                <DropShadowEffect Color="{DynamicResource ShadowColor}"
                                  Opacity="0.06"
                                  ShadowDepth="2"
                                  BlurRadius="12"
                                  Direction="270" />
            </Border.Effect>

            <Grid Margin="20,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Logo区域 -->
                <StackPanel Grid.Column="0"
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            Margin="0,16">
                    <Border Width="48"
                            Height="48"
                            CornerRadius="14"
                            Background="{DynamicResource PrimaryBrush}"
                            Margin="0,0,16,0"
                            RenderTransformOrigin="0.5,0.5">
                        <Border.Effect>
                            <StaticResource ResourceKey="LogoShadow" />
                        </Border.Effect>
                        <Border.RenderTransform>
                            <RotateTransform Angle="0" />
                        </Border.RenderTransform>
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                                                         To="360"
                                                         Duration="0:0:0.8">
                                            <DoubleAnimation.EasingFunction>
                                                <StaticResource ResourceKey="EaseOutBack_04" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                        <Path Data="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"
                              Stroke="{DynamicResource ReverseTextBrush}"
                              StrokeThickness="2.5"
                              StrokeLineJoin="Round"
                              StrokeStartLineCap="Round"
                              StrokeEndLineCap="Round"
                              Stretch="Uniform"
                              Width="26"
                              Height="26" />
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="NVH自动化测试平台"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource PrimaryTextBrush}"
                                   Margin="0,0,0,2" />
                        <Border Background="{DynamicResource LightPrimaryBrush}"
                                CornerRadius="6"
                                Padding="8,2,8,3"
                                HorizontalAlignment="Left">
                            <TextBlock Text="{Binding Source={x:Static utils:AssemblyInfo.Version}}"
                                       FontSize="10"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource PrimaryBrush}" />
                        </Border>
                    </StackPanel>
                </StackPanel>

                <!-- 导航菜单 -->
                <Grid Grid.Column="1"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Margin="40,0">
                    <Border Background="{DynamicResource ThirdlyRegionBrush}"
                            CornerRadius="16"
                            Padding="10,6"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Effect="{StaticResource LightShadow}"
                            ClipToBounds="False">
                        <ScrollViewer Style="{StaticResource NavScrollViewerStyle}"
                                      HorizontalScrollBarVisibility="Hidden"
                                      VerticalScrollBarVisibility="Disabled"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      CanContentScroll="False">
                            <ItemsControl ItemsSource="{Binding MenuItems}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal"
                                                    HorizontalAlignment="Center" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <RadioButton Content="{Binding Title}"
                                                     Style="{StaticResource NavButtonStyle}"
                                                     IsChecked="{Binding IsSelected, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                     Tag="{Binding Icon}"
                                                     GroupName="Navigation"
                                                     Visibility="{Binding IsVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                                                     Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                     CommandParameter="{Binding NavigationKey}"
                                                     HorizontalAlignment="Center"
                                                     VerticalAlignment="Center"
                                                     HorizontalContentAlignment="Center"
                                                     VerticalContentAlignment="Center" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Border>
                </Grid>

                <!-- 右侧工具栏 - 扁平化优化版 -->
                <StackPanel Grid.Column="2"
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            Margin="0,0,20,0">

                    <!-- 系统状态 - 扁平化设计 -->
                    <Border Background="{DynamicResource LightSuccessBrush}"
                            CornerRadius="10"
                            x:Name="systemBorder"
                            Padding="12,6"
                            Margin="0,0,16,0"
                            Height="40"
                            BorderBrush="{DynamicResource SuccessBrush}"
                            BorderThickness="0">
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                         To="1.02"
                                                         Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <StaticResource ResourceKey="EaseOutCubic" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                         To="1.02"
                                                         Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <StaticResource ResourceKey="EaseOutCubic" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <ThicknessAnimation Storyboard.TargetProperty="BorderThickness"
                                                            To="1"
                                                            Duration="0:0:0.2">
                                            <ThicknessAnimation.EasingFunction>
                                                <StaticResource ResourceKey="EaseOutCubic" />
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                         To="1"
                                                         Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <DoubleAnimation Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                         To="1"
                                                         Duration="0:0:0.2">
                                            <DoubleAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                        <ThicknessAnimation Storyboard.TargetProperty="BorderThickness"
                                                            To="0"
                                                            Duration="0:0:0.2">
                                            <ThicknessAnimation.EasingFunction>
                                                <CubicEase EasingMode="EaseOut" />
                                            </ThicknessAnimation.EasingFunction>
                                        </ThicknessAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                        <Border.RenderTransform>
                            <ScaleTransform CenterX="0.5"
                                            CenterY="0.5" />
                        </Border.RenderTransform>
                        <Border.RenderTransformOrigin>
                            <Point X="0.5"
                                   Y="0.5" />
                        </Border.RenderTransformOrigin>
                        <StackPanel Orientation="Horizontal">
                            <!-- 状态指示点 -->
                            <Grid Width="8"
                                  Height="8"
                                  Margin="0,0,8,0"
                                  VerticalAlignment="Center">
                                <Ellipse Width="8"
                                         Height="8"
                                         Fill="{DynamicResource SuccessBrush}">
                                    <Ellipse.Triggers>
                                        <EventTrigger RoutedEvent="Loaded">
                                            <BeginStoryboard>
                                                <Storyboard RepeatBehavior="Forever">
                                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                     From="1"
                                                                     To="0.4"
                                                                     Duration="0:0:1.5"
                                                                     AutoReverse="True">
                                                        <DoubleAnimation.EasingFunction>
                                                            <SineEase EasingMode="EaseInOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Ellipse.Triggers>
                                </Ellipse>
                                <!-- 呼吸光晕效果 -->
                                <Ellipse Width="8"
                                         Height="8"
                                         Fill="{DynamicResource SuccessBrush}"
                                         Opacity="0.3">
                                    <Ellipse.Triggers>
                                        <EventTrigger RoutedEvent="Loaded">
                                            <BeginStoryboard>
                                                <Storyboard RepeatBehavior="Forever">
                                                    <DoubleAnimation Storyboard.TargetProperty="Width"
                                                                     From="8"
                                                                     To="16"
                                                                     Duration="0:0:1.5"
                                                                     AutoReverse="True">
                                                        <DoubleAnimation.EasingFunction>
                                                            <SineEase EasingMode="EaseInOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <DoubleAnimation Storyboard.TargetProperty="Height"
                                                                     From="8"
                                                                     To="16"
                                                                     Duration="0:0:1.5"
                                                                     AutoReverse="True">
                                                        <DoubleAnimation.EasingFunction>
                                                            <SineEase EasingMode="EaseInOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                     From="0.3"
                                                                     To="0"
                                                                     Duration="0:0:1.5"
                                                                     AutoReverse="True">
                                                        <DoubleAnimation.EasingFunction>
                                                            <SineEase EasingMode="EaseInOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Ellipse.Triggers>
                                </Ellipse>
                            </Grid>
                            <TextBlock Text="系统正常"
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource DarkSuccessBrush}" />
                        </StackPanel>
                    </Border>

                    <!-- 用户信息卡片 - 扁平化设计 -->
                    <Grid Margin="0,0,16,0">
                        <!-- 已登录状态 -->
                        <ToggleButton x:Name="UserMenuToggle"
                                      IsChecked="{Binding IsUserMenuOpen, Mode=TwoWay}"
                                      Visibility="{Binding IsLoggedIn, Converter={StaticResource LoginStatusToVisibilityConverter}, ConverterParameter='LoggedIn'}"
                                      Background="{DynamicResource RegionBrush}"
                                      BorderThickness="0"
                                      Cursor="Hand"
                                      Height="50"
                                      MinWidth="140">
                            <ToggleButton.Template>
                                <ControlTemplate TargetType="ToggleButton">
                                    <Border x:Name="border"
                                            Background="{TemplateBinding Background}"
                                            CornerRadius="10"
                                            Padding="8,0,12,0"
                                            BorderThickness="0"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            MinWidth="{TemplateBinding MinWidth}">
                                        <Border.RenderTransform>
                                            <ScaleTransform />
                                        </Border.RenderTransform>
                                        <Border.RenderTransformOrigin>
                                            <Point X="0.5"
                                                   Y="0.5" />
                                        </Border.RenderTransformOrigin>
                                        <StackPanel Orientation="Horizontal"
                                                    VerticalAlignment="Center">
                                            <!-- 头像 -->
                                            <Border x:Name="avatarBorder"
                                                    Width="34"
                                                    Height="34"
                                                    CornerRadius="8"
                                                    Background="{DynamicResource LightPrimaryBrush}"
                                                    BorderBrush="{DynamicResource PrimaryBrush}"
                                                    BorderThickness="1.5"
                                                    Margin="0,0,10,0">
                                                <TextBlock Text="{Binding CurrentUserName, Converter={StaticResource FirstLetterConverter}}"
                                                           FontSize="15"
                                                           FontWeight="Bold"
                                                           Foreground="{DynamicResource PrimaryBrush}"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" />
                                            </Border>
                                            <!-- 用户信息 -->
                                            <StackPanel Orientation="Vertical"
                                                        VerticalAlignment="Center">
                                                <TextBlock Text="{Binding CurrentUserName}"
                                                           FontSize="13"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource PrimaryTextBrush}"
                                                           Margin="0,0,0,4" />
                                                <Border Background="{Binding CurrentUserRole, Converter={StaticResource UserRoleToColorConverter}, ConverterParameter='Light'}"
                                                        CornerRadius="4"
                                                        Padding="6,2"
                                                        HorizontalAlignment="Left">
                                                    <TextBlock Text="{Binding CurrentUserRole, Converter={StaticResource UserRoleToStringConverter}}"
                                                               FontSize="9"
                                                               FontWeight="Bold"
                                                               Foreground="{Binding CurrentUserRole, Converter={StaticResource UserRoleToColorConverter}, ConverterParameter='Dark'}" />
                                                </Border>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <!-- 悬停效果 -->
                                        <Trigger Property="IsMouseOver"
                                                 Value="True">
                                            <Trigger.EnterActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                                         To="1.02"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                                         To="1.02"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <ColorAnimation Storyboard.TargetName="border"
                                                                        Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                                        To="{StaticResource SecondaryBorderColor}"
                                                                        Duration="0:0:0.2" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </Trigger.EnterActions>
                                            <Trigger.ExitActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                                         To="1"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                                         To="1"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <ColorAnimation Storyboard.TargetName="border"
                                                                        Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                                        To="{StaticResource BorderColor}"
                                                                        Duration="0:0:0.2" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </Trigger.ExitActions>
                                            <Setter TargetName="border"
                                                    Property="Background"
                                                    Value="{DynamicResource SecondaryRegionBrush}" />
                                        </Trigger>
                                        <!-- 激活状态 -->
                                        <Trigger Property="IsChecked"
                                                 Value="True">
                                            <Setter TargetName="border"
                                                    Property="BorderBrush"
                                                    Value="{DynamicResource PrimaryBrush}" />
                                            <Setter TargetName="border"
                                                    Property="BorderThickness"
                                                    Value="1.5" />
                                            <Setter TargetName="border"
                                                    Property="Background"
                                                    Value="{DynamicResource LightPrimaryBrush}" />
                                            <Setter TargetName="avatarBorder"
                                                    Property="BorderThickness"
                                                    Value="2" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ToggleButton.Template>
                        </ToggleButton>

                        <!-- 未登录状态 - 点击登录 -->
                        <Button Visibility="{Binding IsLoggedIn, Converter={StaticResource LoginStatusToVisibilityConverter}, ConverterParameter='NotLoggedIn'}"
                                Command="{Binding ShowLoginCommand}"
                                Background="{DynamicResource RegionBrush}"
                                Height="50"
                                BorderThickness="0"
                                Cursor="Hand"
                                MinWidth="140">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border"
                                            Background="{TemplateBinding Background}"
                                            CornerRadius="10"
                                            Padding="8,0,12,0"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="1"
                                            MinWidth="{TemplateBinding MinWidth}">
                                        <Border.RenderTransform>
                                            <ScaleTransform />
                                        </Border.RenderTransform>
                                        <Border.RenderTransformOrigin>
                                            <Point X="0.5"
                                                   Y="0.5" />
                                        </Border.RenderTransformOrigin>
                                        <StackPanel Orientation="Horizontal"
                                                    VerticalAlignment="Center">
                                            <Border Width="34"
                                                    Height="34"
                                                    CornerRadius="8"
                                                    Background="{DynamicResource ThirdlyRegionBrush}"
                                                    BorderBrush="{DynamicResource BorderBrush}"
                                                    BorderThickness="1"
                                                    Margin="0,0,10,0">
                                                <Path Data="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                                                      Fill="{DynamicResource SecondaryTextBrush}"
                                                      Stretch="Uniform"
                                                      Width="16"
                                                      Height="16"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Opacity="0.6" />
                                            </Border>
                                            <StackPanel Orientation="Vertical"
                                                        VerticalAlignment="Center">
                                                <TextBlock Text="未登录"
                                                           FontSize="13"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource SecondaryTextBrush}"
                                                           Margin="0,0,0,4" />
                                                <TextBlock Text="点击登录 →"
                                                           FontSize="9"
                                                           FontWeight="Medium"
                                                           Foreground="{DynamicResource PrimaryBrush}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver"
                                                 Value="True">
                                            <Trigger.EnterActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                                         To="1.02"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                                         To="1.02"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <ColorAnimation Storyboard.TargetName="border"
                                                                        Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                                        To="{StaticResource PrimaryColor}"
                                                                        Duration="0:0:0.2" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </Trigger.EnterActions>
                                            <Trigger.ExitActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                                         To="1"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <DoubleAnimation Storyboard.TargetName="border"
                                                                         Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                                         To="1"
                                                                         Duration="0:0:0.2">
                                                            <DoubleAnimation.EasingFunction>
                                                                <CubicEase EasingMode="EaseOut" />
                                                            </DoubleAnimation.EasingFunction>
                                                        </DoubleAnimation>
                                                        <ColorAnimation Storyboard.TargetName="border"
                                                                        Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                                        To="{StaticResource BorderColor}"
                                                                        Duration="0:0:0.2" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </Trigger.ExitActions>
                                            <Setter TargetName="border"
                                                    Property="Background"
                                                    Value="{DynamicResource SecondaryRegionBrush}" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>

                        <!-- Popup菜单 -->
                        <Popup x:Name="UserMenuPopup"
                               PlacementTarget="{Binding RelativeSource={RelativeSource AncestorType=Grid}}"
                               Placement="Bottom"
                               IsOpen="{Binding IsUserMenuOpen}"
                               AllowsTransparency="True"
                               StaysOpen="False"
                               VerticalOffset="8"
                               HorizontalOffset="0">
                            <local:UserMenuControl DataContext="{Binding}" />
                        </Popup>
                    </Grid>

                    <!-- 工具按钮 - 扁平化设计 -->
                    <Button Width="40"
                            Height="40"
                            Background="{DynamicResource RegionBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1"
                            Cursor="Hand"
                            ToolTip="设置">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="10">
                                    <Border.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform />
                                            <RotateTransform />
                                        </TransformGroup>
                                    </Border.RenderTransform>
                                    <Border.RenderTransformOrigin>
                                        <Point X="0.5"
                                               Y="0.5" />
                                    </Border.RenderTransformOrigin>
                                    <Path x:Name="iconPath"
                                          Data="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"
                                          Fill="{DynamicResource SecondaryTextBrush}"
                                          Stretch="Uniform"
                                          Width="18"
                                          Height="18"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Opacity="0.7" />
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver"
                                             Value="True">
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="border"
                                                                     Storyboard.TargetProperty="(Border.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)"
                                                                     To="1.05"
                                                                     Duration="0:0:0.2">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <DoubleAnimation Storyboard.TargetName="border"
                                                                     Storyboard.TargetProperty="(Border.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)"
                                                                     To="1.05"
                                                                     Duration="0:0:0.2">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <DoubleAnimation Storyboard.TargetName="border"
                                                                     Storyboard.TargetProperty="(Border.RenderTransform).(TransformGroup.Children)[1].(RotateTransform.Angle)"
                                                                     To="90"
                                                                     Duration="0:0:0.3">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <ColorAnimation Storyboard.TargetName="border"
                                                                    Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                                    To="{StaticResource PrimaryColor}"
                                                                    Duration="0:0:0.2" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                        <Trigger.ExitActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetName="border"
                                                                     Storyboard.TargetProperty="(Border.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)"
                                                                     To="1"
                                                                     Duration="0:0:0.2">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <DoubleAnimation Storyboard.TargetName="border"
                                                                     Storyboard.TargetProperty="(Border.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)"
                                                                     To="1"
                                                                     Duration="0:0:0.2">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <DoubleAnimation Storyboard.TargetName="border"
                                                                     Storyboard.TargetProperty="(Border.RenderTransform).(TransformGroup.Children)[1].(RotateTransform.Angle)"
                                                                     To="0"
                                                                     Duration="0:0:0.3">
                                                        <DoubleAnimation.EasingFunction>
                                                            <CubicEase EasingMode="EaseOut" />
                                                        </DoubleAnimation.EasingFunction>
                                                    </DoubleAnimation>
                                                    <ColorAnimation Storyboard.TargetName="border"
                                                                    Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)"
                                                                    To="{StaticResource BorderColor}"
                                                                    Duration="0:0:0.2" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.ExitActions>
                                        <Setter TargetName="border"
                                                Property="Background"
                                                Value="{DynamicResource SecondaryRegionBrush}" />
                                        <Setter TargetName="iconPath"
                                                Property="Fill"
                                                Value="{DynamicResource PrimaryBrush}" />
                                        <Setter TargetName="iconPath"
                                                Property="Opacity"
                                                Value="1" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
    </hc:Window.NonClientAreaContent>


    <Grid Background="{DynamicResource BackgroundBrush}">
        <!-- 内容框架 -->
        <Frame x:Name="MainFrame"
               NavigationUIVisibility="Hidden"
               Margin="0" />

        <!-- 空状态提示 -->
        <Border x:Name="EmptyStatePanel"
                Visibility="Collapsed"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Background="{DynamicResource SurfaceBrush}"
                CornerRadius="24"
                Padding="60,52"
                MaxWidth="520">
            <Border.Effect>
                <DropShadowEffect Color="{DynamicResource ShadowColor}"
                                  Opacity="0.12"
                                  ShadowDepth="4"
                                  BlurRadius="32"
                                  Direction="270" />
            </Border.Effect>
            <StackPanel HorizontalAlignment="Center">
                <Grid Width="110"
                      Height="110"
                      HorizontalAlignment="Center"
                      Margin="0,0,0,32">
                    <Ellipse Width="110"
                             Height="110"
                             Opacity="0.08">
                        <Ellipse.Fill>
                            <LinearGradientBrush StartPoint="0,0"
                                                 EndPoint="1,1">
                                <GradientStop Color="{DynamicResource PrimaryColor}"
                                              Offset="0" />
                                <GradientStop Color="{DynamicResource AccentColor}"
                                              Offset="1" />
                            </LinearGradientBrush>
                        </Ellipse.Fill>
                    </Ellipse>
                    <Path Data="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                          Stroke="{DynamicResource PrimaryBrush}"
                          StrokeThickness="2.5"
                          StrokeLineJoin="Round"
                          StrokeStartLineCap="Round"
                          StrokeEndLineCap="Round"
                          Stretch="Uniform"
                          Width="52"
                          Height="52"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center" />
                </Grid>

                <TextBlock Text="序列编组加载中..."
                           FontSize="24"
                           FontWeight="Bold"
                           Foreground="{DynamicResource PrimaryTextBrush}"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,16" />
                <TextBlock Text="系统正在获取测试序列数据，请稍候"
                           FontSize="15"
                           Foreground="{DynamicResource SecondaryTextBrush}"
                           HorizontalAlignment="Center"
                           TextAlignment="Center"
                           TextWrapping="Wrap"
                           Opacity="0.85"
                           LineHeight="26" />

                <Border Height="6"
                        Width="300"
                        Background="{DynamicResource LightPrimaryBrush}"
                        CornerRadius="3"
                        Margin="0,36,0,0"
                        ClipToBounds="True">
                    <Border x:Name="LoadingBar"
                            Background="{DynamicResource PrimaryBrush}"
                            CornerRadius="3"
                            HorizontalAlignment="Left"
                            Width="100">
                        <Border.Effect>
                            <DropShadowEffect Color="{DynamicResource PrimaryColor}"
                                              Opacity="0.6"
                                              ShadowDepth="0"
                                              BlurRadius="16" />
                        </Border.Effect>
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="Loaded">
                                <BeginStoryboard>
                                    <Storyboard RepeatBehavior="Forever">
                                        <DoubleAnimation Storyboard.TargetName="LoadingBar"
                                                         Storyboard.TargetProperty="(Border.RenderTransform).(TranslateTransform.X)"
                                                         From="-100"
                                                         To="300"
                                                         Duration="0:0:1.8">
                                            <DoubleAnimation.EasingFunction>
                                                <StaticResource ResourceKey="EaseInOutSine" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                        <Border.RenderTransform>
                            <TranslateTransform />
                        </Border.RenderTransform>
                    </Border>
                </Border>
            </StackPanel>
        </Border>
    </Grid>

</hc:Window>
